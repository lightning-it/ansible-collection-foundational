---
- name: Example - lit.foundational.tf_runner
  hosts: localhost
  connection: local
  gather_facts: false

  vars:
    tf_runner_workdir: "/tmp/tf-runner-example"

  tasks:
    - name: "Ensure Terraform working directory exists"
      ansible.builtin.file:
        path: "{{ tf_runner_workdir }}"
        state: directory
        mode: "0750"

    - name: "Write minimal Terraform configuration"
      ansible.builtin.copy:
        dest: "{{ tf_runner_workdir }}/main.tf"
        mode: "0640"
        content: |
          terraform {
            required_version = ">= 1.3.0"
          }

    - name: "Run lit.foundational.tf_runner"
      ansible.builtin.include_role:
        name: "lit.foundational.tf_runner"
      vars:
        tf_runner_clean_state: true
        tf_runner_skip_apply: false
        tf_runner_vars: {}
