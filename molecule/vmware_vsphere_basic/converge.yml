---
- name: Converge vmware_vsphere role (stub mode)
  hosts: vmware_vsphere
  gather_facts: false
  vars:
    ansible_connection: local
    vmware_vsphere_stub_mode: true

  pre_tasks:
    - name: Ensure python3 is present
      ansible.builtin.raw: |
        if ! command -v python3 >/dev/null 2>&1; then
          dnf -y install python3
        fi
      changed_when: false

  roles:
    - role: lit.foundational.vmware_vsphere
